"use strict";var __extends=this&&this.__extends||function(){var o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};return function(e,t){function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}();Object.defineProperty(exports,"__esModule",{value:!0});var helpers_1=require("../../helpers"),boxrec_parse_bouts_parseBouts_1=require("../event/boxrec.parse.bouts.parseBouts"),boxrec_profile_constants_1=require("./boxrec.profile.constants"),profileTableEl=".profileTable",BoxrecPageProfile=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"birthName",{get:function(){var e=this.parseProfileTableData(boxrec_profile_constants_1.BoxrecProfileTable.birthName);return e||null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"birthPlace",{get:function(){var e=this.parseProfileTableData(boxrec_profile_constants_1.BoxrecProfileTable.birthPlace);return e?this.$("<div>"+e+"</div>").text()||"":null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"born",{get:function(){var e=this.parseProfileTableData(boxrec_profile_constants_1.BoxrecProfileTable.born);if(e){var t=e.match(/(\d{4}\-\d{2}\-\d{2})/);if(t)return t[1]}return null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"globalId",{get:function(){var e=this.$(profileTableEl).find("h2").text().match(/\d+/);if(e){var t=parseInt(e[0],10);if(!isNaN(t))return t}return null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){var e=this.$("script[type='application/ld+json']").html();return e&&JSON.parse(e),null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.$(profileTableEl).find("h1").text()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"otherInfo",{get:function(){return this.parseOtherInfo()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"picture",{get:function(){return this.$(".profileTablePhoto img").attr("src")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"residence",{get:function(){var e=this.parseProfileTableData(boxrec_profile_constants_1.BoxrecProfileTable.residence);return e?this.$("<div>"+e+"</div>").text()||"":null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"role",{get:function(){var n=this,i=[],e=this.$(profileTableEl).find("h2").parent();if(e.find(".fa-user-circle").length){var t=this.$("link[rel='canonical']").attr("href").match(/\/en\/(\w+)\/\d+/);if(!t||!t.length)throw new Error("Could not get BoxRec role?: "+this.globalId);i.push({id:this.globalId,name:t[1]})}return e.find("a").not('[style*="allSports="]').each(function(e,t){var r=t.attribs.href.match(/(\d+)$/),o=helpers_1.trimRemoveLineBreaks(n.$(t).text());r&&o&&i.push({id:parseInt(r[1],10),name:o})}).get(),i.sort(function(e,t){return e.name>t.name?1:e.name<t.name?-1:0}),i},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"status",{get:function(){var e=this.parseProfileTableData(boxrec_profile_constants_1.BoxrecProfileTable.status);return e||null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"profileTableBody",{get:function(){return this.$(profileTableEl).find("table.rowTable tbody")},enumerable:!0,configurable:!0}),t.prototype.getBouts=function(e,t){var r=helpers_1.getHeaderColumnText(this.$(".dataTable"));return e.map(function(e){return new t(r,e[0],e[1])})},t.prototype.parseProfileTableData=function(e){var t=this.profileTableBody.find('tr:contains("'+e+'")').find("td:nth-child(2)").html();if(e&&t)return t.trim()},t.prototype.parseOtherInfo=function(){var n=this,i=[],a=Object.values(boxrec_profile_constants_1.BoxrecProfileTable);return this.profileTableBody.find("tr").each(function(e,t){var r=n.$(t).find("td:nth-child(2)").html(),o=helpers_1.trimRemoveLineBreaks(n.$(t).find("td:nth-child(1)").text());o&&r&&"ID"!==o.substr(0,2)&&!a.includes(o)&&i.push([o,r])}),i},t}(boxrec_parse_bouts_parseBouts_1.BoxrecParseBoutsParseBouts);exports.BoxrecPageProfile=BoxrecPageProfile;