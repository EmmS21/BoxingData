"use strict";var __extends=this&&this.__extends||function(){var o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};return function(e,t){function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),__decorate=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;0<=s;s--)(n=e[s])&&(a=(i<3?n(a):3<i?n(t,r,a):n(t,r))||a);return 3<i&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(exports,"__esModule",{value:!0});var boxrec_requests_1=require("boxrec-requests"),boxrec_common_tables_columns_class_1=require("../../boxrec-common-tables/boxrec-common-tables-columns.class"),output_decorator_1=require("../../decorators/output.decorator"),helpers_1=require("../../helpers"),boxrec_event_1=require("./boxrec.event"),boxrec_event_helpers_1=require("./boxrec.event.helpers"),BoxrecPageEvent=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return __extends(t,e),n=t,Object.defineProperty(t.prototype,"commission",{get:function(){var e=this.parseEventData("commission");return e?e.trim():null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"date",{get:function(){var e=this.parseDate();return e?helpers_1.trimRemoveLineBreaks(e):e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"doctors",{get:function(){var r=this;return this.$("<div>"+this.parseEventData(boxrec_requests_1.BoxrecRole.doctor)+"</div>").find("a").map(function(e,t){return r.$.html(t)}).get().map(function(e){return boxrec_common_tables_columns_class_1.BoxrecCommonTablesColumnsClass.parseNameAndId(e)})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){var e=this.$(this.parseEventResults()).find("h2").next().find("a[href*='/media/index']").attr("href");return e?function(e){if(e){var t=e.match(/(\d+)$/);if(t&&t[1])return parseInt(t[1],10)}return null}(e):null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inspector",{get:function(){var r=this,e=this.$("<div>"+this.parseEventData(boxrec_requests_1.BoxrecRole.inspector)+"</div>"),o={id:null,name:null};return e.find("a").each(function(e,t){o=boxrec_common_tables_columns_class_1.BoxrecCommonTablesColumnsClass.parseNameAndId(r.$(t).text())}),o},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"location",{get:function(){var e=Object.assign({},boxrec_event_helpers_1.emptyLocationObject),t=this.$(this.parseEventResults()).find("thead table > tbody tr:nth-child(2) b").html();if(null===t){var r=this.$(".page a[href*='/locations/event']").parents("div").clone();r.remove("h2"),r.find("a:nth-child(1)").remove(),t=r.html()}if(null!==t){var o=this.$("<div>"+helpers_1.trimRemoveLineBreaks(t)+"</div>").find("a");e.venue=n.getVenueInformation(o),e.location=n.getLocationInformation(o)}return e},enumerable:!0,configurable:!0}),t.prototype.parseMatchmakers=function(){return this.parseEventData(boxrec_requests_1.BoxrecRole.matchmaker)},Object.defineProperty(t.prototype,"media",{get:function(){return this.television},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"television",{get:function(){var r=this,e=this.parseEventData("media");return e?e.split(",").map(function(e){var t=r.$("<span>"+e+"</span>").text();return helpers_1.trimRemoveLineBreaks(t)}):[]},enumerable:!0,configurable:!0}),t.prototype.parsePromoters=function(){return this.parseEventData(boxrec_requests_1.BoxrecRole.promoter)},t.prototype.parseDate=function(){var e=this.parseEventResults(),t=this.$(e).find("h2").text();return t?new Date(t).toISOString().slice(0,10):null},t.prototype.parseEventResults=function(){return this.$("table")},t=n=__decorate([output_decorator_1.OutputGetter([{function:function(e){return e.map(function(e){return e.output})},method:"bouts"},"commission","date","doctors","id","inspector","location","matchmakers","media","numberOfBouts","promoters","television"])],t)}(boxrec_event_1.BoxrecEvent);exports.BoxrecPageEvent=BoxrecPageEvent;