"use strict";var __extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};return function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),__decorate=this&&this.__decorate||function(e,t,r,n){var o,a=arguments.length,i=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,n);else for(var c=e.length-1;0<=c;c--)(o=e[c])&&(i=(a<3?o(i):3<a?o(t,r,i):o(t,r))||i);return 3<a&&i&&Object.defineProperty(t,r,i),i};Object.defineProperty(exports,"__esModule",{value:!0});var bouts_decorator_1=require("../../decorators/bouts.decorator"),helpers_1=require("../../helpers"),boxrec_page_event_bout_row_1=require("./boxrec.page.event.bout.row"),boxrec_parse_bouts_1=require("./boxrec.parse.bouts"),BoxrecEvent=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var r;return __extends(t,e),(r=t).getVenueInformation=function(e){var t={id:null,name:null};if(1<e.length){var r=e.get(0).attribs.href.match(/(\d+)$/),n=e.get(0).children[0].data;r&&r[1]&&n&&(t.id=parseInt(r[1],10),t.name=n)}return t},t.getLocationInformation=function(e){var t=+(3===e.length||4===e.length),r={country:{id:null,name:null},region:{id:null,name:null},town:{id:null,name:null}},n=e.get(t).attribs.href.match(helpers_1.townRegionCountryRegex);if(n){var o=n[3];o&&(r.town.id=parseInt(o,10),r.town.name=e.get(1).children[0].data),4===e.length?(r.region={id:helpers_1.getLocationValue(e.get(2).attribs.href,"region"),name:e.get(2).children[0].data},r.country={id:helpers_1.getLocationValue(e.get(3).attribs.href,"country"),name:e.get(3).children[0].data}):3===e.length?r.country={id:helpers_1.getLocationValue(e.get(2).attribs.href,"country"),name:e.get(2).children[0].data}:2===e.length&&(r.town={id:helpers_1.getLocationValue(e.get(0).attribs.href,"town"),name:e.get(0).children[0].data}),2===e.length&&(r.country={id:helpers_1.getLocationValue(e.get(1).attribs.href,"country"),name:e.get(1).children[0].data}),1===e.length&&(r.country={id:helpers_1.getLocationValue(e.get(0).attribs.href,"country"),name:e.get(0).children[0].data})}return r},Object.defineProperty(t.prototype,"location",{get:function(){var e={location:{country:{id:null,name:null},region:{id:null,name:null},town:{id:null,name:null}},venue:{id:null,name:null}},t=this.$("<div>"+this.parseLocation()+"</div>").find("a");return e.venue=r.getVenueInformation(t),e.location=r.getLocationInformation(t),e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"matchmakers",{get:function(){var o=this,e=this.$("<div>"+this.parseMatchmakers()+"</div>"),a=[];return e.find("a").each(function(e,t){var r=o.$(t).get(0).attribs.href.match(/(\d+)$/);if(r){var n=o.$(t).text();a.push({id:parseInt(r[1],10),name:n})}}),a},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"promoters",{get:function(){var n=this;return this.$(".page a[href*='/promoter']").map(function(e,t){var r=n.$(t).attr("href").match(/\/promoter\/(\d+)$/);if(!r)throw new Error("Could not get promoter ID from link");return{id:r[1],name:n.$(t).text()}}).toArray()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tickets",{get:function(){var e=this.parseEventData("tickets",!1);return e?helpers_1.trimRemoveLineBreaks(e):null},enumerable:!0,configurable:!0}),t.prototype.getPeopleTable=function(){return this.$("table thead table tbody tr")},t.prototype.parseEventData=function(o,a){var i=this;void 0===a&&(a=!0);var c="";return this.getPeopleTable().each(function(e,t){var r=i.$(t).find("td:nth-child(1)").text().trim(),n=i.$(t).find("td:nth-child(2)");r===o&&(c=a?n.html():n.text())}),c},t.prototype.parseLocation=function(){throw new Error("Needs to be overridden by child class")},t.prototype.parseMatchmakers=function(){throw new Error("Needs to be overridden by child class")},t.prototype.parsePromoters=function(){throw new Error("Needs to be overridden by child class")},t=r=__decorate([bouts_decorator_1.BoutsGetter("table",boxrec_page_event_bout_row_1.BoxrecPageEventBoutRow,2)],t)}(boxrec_parse_bouts_1.BoxrecParseBouts);exports.BoxrecEvent=BoxrecEvent;