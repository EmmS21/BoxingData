"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var cheerio=require("cheerio"),querystring=require("querystring"),boxrec_constants_1=require("../boxrec-pages/boxrec.constants"),boxrec_champions_constants_1=require("../boxrec-pages/champions/boxrec.champions.constants"),boxrec_event_constants_1=require("../boxrec-pages/event/boxrec.event.constants"),helpers_1=require("../helpers"),$=cheerio.load("<div></div>"),BoxrecCommonTablesColumnsClass=function(){function v(){}return v.parseAlias=function(e){return e?helpers_1.trimRemoveLineBreaks(e):null},v.parseCareer=function(e){var n=e.match(/(\d{4})-(\d{4})/);return n&&3===n.length?[parseInt(n[1],10),parseInt(n[2],10)]:[null,null]},v.parseDivision=function(e){var n=helpers_1.trimRemoveLineBreaks(e.toLowerCase()),r=/weight$/.test(n)?n:n+"weight",t=Object.values(boxrec_champions_constants_1.WeightDivision).find(function(e){return e===r});return t||null},v.parseId=function(e){var n=$("<div>"+e+"</div>").find("a").attr("href");if(n){var r=n.match(/(\d+)$/);if(r&&r[1])return parseInt(r[1],10)}return null},v.parseJudges=function(l){var e=$("<div>"+l+"</div>"),d=[];return e.find("a").each(function(e,n){var r=$(n).get(0).attribs.href.match(/judge\/(\d+)$/);if(r&&r[1]){for(var t=v.parseIdAndName(n,r),s=t.id,a=t.name,i=/<\/a>\s(\d{1,3})-(\d{1,3})/g,o=[],u=void 0,c=0;(u=i.exec(l))&&u[1]&&u[2]&&c===d.length&&o.push(parseInt(u[1],10),parseInt(u[2],10)),c++,u;);d.push({id:s,name:a,scorecard:o})}}),d},v.parseLast6Column=function(e){var t=[];return $(e).find("div.last6").each(function(e,n){var r=n.attribs.class;r.includes("bgW")?t.push(boxrec_constants_1.WinLossDraw.win):r.includes("bgD")?t.push(boxrec_constants_1.WinLossDraw.draw):r.includes("bgL")?t.push(boxrec_constants_1.WinLossDraw.loss):t.push(boxrec_constants_1.WinLossDraw.unknown)}),t},v.parseLocationLink=function(e,n){void 0===n&&(n=0);var o={country:{id:null,name:null},region:{id:null,name:null},town:{id:null,name:null}};return $("<div>"+e+"</div>").find("a").each(function(e,n){var r=$(n).attr("href"),t=$(n).text(),s=helpers_1.whatTypeOfLink(r),a=r.match(/(\w+)\=(\w+)/g);if(a){var i=a.map(function(e){return querystring.parse(e)}).filter(function(e){return Object.keys(e)[0]===s}).map(function(e){var n=Object.values(e)[0],r=parseInt(n,10);return isNaN(r)?n:r})[0];o[s]={id:i,name:t}}}),o},v.parseName=function(e){var n=$("<div>"+e+"</div>").text();return"*"===(n=helpers_1.trimRemoveLineBreaks(n)).slice(-1)&&(n=n.slice(0,-1)),n},v.parseNameAndId=function(e){if("TBA"!==helpers_1.trimRemoveLineBreaks(e)){var n=$("<div>"+e+"</div>"),r=n.find("a").attr("href");if(r){var t=r.match(/(\d+)$/);if(t&&t[1])return{id:parseInt(t[1],10),name:n.find("a").text()}}}return{id:null,name:null}},v.parseNumberOfRounds=function(e){var n=[null,null],r=e.trim().split("/").map(function(e){return parseInt(e,10)});return 2===r.length?n=r:1!==r.length||isNaN(r[0])||(n=[null,r[0]]),n},v.parseOutcome=function(e){var n=e;switch(n=n.trim()){case"W":return boxrec_constants_1.WinLossDraw.win;case"D":return boxrec_constants_1.WinLossDraw.draw;case"L":return boxrec_constants_1.WinLossDraw.loss;case"S":return boxrec_constants_1.WinLossDraw.scheduled;default:return boxrec_constants_1.WinLossDraw.unknown}},v.parseOutcomeByWayOf=function(e,n){if(void 0===n&&(n=!1),helpers_1.trimRemoveLineBreaks(e)){var r=$("<div>"+e+"</div>");r.find("div").remove();var t=r.text();return t=t.trim(),n?boxrec_event_constants_1.BoxingBoutOutcome[t]:t}return null},v.parseRating=function(e,n,r){var t=$(e),s=t.find(n),a=t.find(r);return 20*s.length+10*a.length},v.parseRecord=function(e){var n={draw:null,loss:null,win:null},r=$("<div>"+e+"</div>");return r.find(".textWon").length&&!e.includes("debut")?(n.win=parseInt(r.find(".textWon").text(),10),n.loss=parseInt(r.find(".textLost").text(),10),n.draw=parseInt(r.find(".textDraw").text(),10)):e.includes("debut")&&(n.win=0,n.loss=0,n.draw=0),n},v.parseReferee=function(e){var n=$("<div>"+e+"</div>"),t={id:null,name:null};return n.find("a").each(function(e,n){var r=$(n).get(0).attribs.href.match(/referee\/(\d+)$/);r&&r[1]&&(t=v.parseIdAndName(n,r))}),t},v.parseTitles=function(e){var u=[],n=$("<div>"+e+"</div>"),c=0;return n.find("a").each(function(e,n){var r=$(n).get(0).attribs,t=r.class,s=r.href;if(t&&t.includes("titleLink")){if((o=s.match(/(\d+\/[\w%]+)$/))&&o[1]){var a=o[1],i=$(n).text();i=helpers_1.replaceWithWeight(i),u.push({id:a,name:i}),c=u.length-1}}else if(s.includes("supervisor")){var o;(o=s.match(/\d+$/))&&(u[c].supervisor={id:parseInt(o[0],10),name:helpers_1.replaceWithWeight($(n).text())})}}),u},v.parseWeight=function(e){var n=e.trim(),r=null;return n.length&&(r=parseInt(n,10),isNaN(parseInt(n.slice(-1),10))&&(r+=helpers_1.convertFractionsToNumber(n.slice(-1)))),r},v.parseIdAndName=function(e,n){var r=parseInt(n[1],10),t=$(e).text();return{id:r,name:t=helpers_1.trimRemoveLineBreaks(t)}},v}();exports.BoxrecCommonTablesColumnsClass=BoxrecCommonTablesColumnsClass;